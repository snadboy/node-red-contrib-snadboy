<script type="text/x-red" data-template-name="sbha">
  <div class="form-row">
    <label for="node-input-name">
      <i class="fa fa-tag"></i> Name
    </label>
    <input type="text" id="node-input-name" placeholder="Name">
  </div>
  <div class="form-row">
    <label for="node-input-serverUrl">
      <i class="fa fa-globe"></i> Server URL
    </label>
    <input type="text" id="node-input-serverUrl" placeholder="http://homeassistant:8123">
  </div>
  <div class="form-row">
    <label for="node-input-apiKey">
      <i class="fa fa-key"></i> API Key
    </label>
    <input type="text" id="node-input-apiKey" placeholder="API Key">
  </div>
</script>

<script type="text/javascript">
  RED.nodes.registerType('sbha', {
    category: 'config',
    defaults: {
      name: { value: '' },
      serverUrl: { value: '', required: true },
      apiKey: { value: '', required: true },
    },
    label: function () {
      return this.name || 'Snadboy Home Assistant'
    },
    oneditprepare: function () {
      $('#node-input-name').val(this.name);
      $('#node-input-serverUrl').val(this.serverUrl);
      $('#node-input-apiKey').val(this.apiKey);
    },
    oneditsave: function () {
      console.log(`oneditsave  serverUrl: ${$('#node-input-serverUrl').val()}  apiKey: ${$('#node-input-apiKey').val()}}`)
      this.name = $('#node-input-name').val();
      this.serverUrl = $('#node-input-serverUrl').val();
      this.apiKey = $('#node-input-apiKey').val();
    },
    oneditok: function () {
      console.log(`oneditok  serverUrl: ${$('#node-input-serverUrl').val()}  apiKey: ${$('#node-input-apiKey').val()}}`)
      this.name = $('#node-input-name').val();
      this.serverUrl = $('#node-input-serverUrl').val();
      this.apiKey = $('#node-input-apiKey').val();
    }
  });
</script>